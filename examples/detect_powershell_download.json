{
	"id": "cb978856-d428-40be-9819-77cc79b7640f",
	"exportID": "cb978856-d428-40be-9819-77cc79b7640f",
	"tenantID": "2d837e5c-c120-439c-844b-b942bc34db2a",
	"tenantName": "Main",
	"kind": "correlationRule",
	"name": "detect_powershell_download",
	"description": "",
	"createdAt": 1683996740567,
	"updatedAt": 1683997730829,
	"folderID": "",
	"userID": "6b6d950d-fbbb-4e5b-8c26-611119714fff",
	"userName": "Administrator",
	"repositoryPackageID": "",
	"packageIntegrationResource": false,
	"payload": {
		"id": "cb978856-d428-40be-9819-77cc79b7640f",
		"name": "detect_powershell_download",
		"kind": "simple",
		"selectors": [
			{
				"tag": "",
				"filter": {
					"id": "",
					"name": "b92bd042-bce7-4dc8-8b24-b217b0cbd85e",
					"root": {
						"group": true,
						"or": false,
						"not": false,
						"conditions": [
							{
								"group": false,
								"or": false,
								"not": false,
								"conditions": [],
								"leftKind": "event",
								"leftEvent": "",
								"leftID": "",
								"leftField": "DeviceCustomString4",
								"leftKeys": [],
								"leftTICategory": "",
								"leftTIField": "",
								"leftShared": false,
								"op": "contains",
								"rightKind": "constant",
								"rightEvent": "",
								"rightID": "",
								"rightField": "",
								"rightKeys": [],
								"rightTICategory": "",
								"rightTIField": "",
								"rightShared": false,
								"constant": "DownloadFile",
								"list": [],
								"ignoreCase": true,
								"filter": null,
								"vulns": {
									"cves": null,
									"minSeverity": 0
								}
							},
							{
								"group": false,
								"or": false,
								"not": false,
								"conditions": [],
								"leftKind": "event",
								"leftEvent": "",
								"leftID": "",
								"leftField": "DestinationProcessName",
								"leftKeys": [],
								"leftTICategory": "",
								"leftTIField": "",
								"leftShared": false,
								"op": "contains",
								"rightKind": "constant",
								"rightEvent": "",
								"rightID": "",
								"rightField": "",
								"rightKeys": [],
								"rightTICategory": "",
								"rightTIField": "",
								"rightShared": false,
								"constant": "powershell.exe",
								"list": [],
								"ignoreCase": false,
								"filter": null,
								"vulns": {
									"cves": null,
									"minSeverity": 0
								}
							},
							{
								"group": false,
								"or": false,
								"not": false,
								"conditions": [],
								"leftKind": "event",
								"leftEvent": "",
								"leftID": "",
								"leftField": "DeviceEventClassID",
								"leftKeys": [],
								"leftTICategory": "",
								"leftTIField": "",
								"leftShared": false,
								"op": "=",
								"rightKind": "constant",
								"rightEvent": "",
								"rightID": "",
								"rightField": "",
								"rightKeys": [],
								"rightTICategory": "",
								"rightTIField": "",
								"rightShared": false,
								"constant": "4688",
								"list": [],
								"ignoreCase": false,
								"filter": null,
								"vulns": {
									"cves": null,
									"minSeverity": 0
								}
							}
						],
						"leftKind": "",
						"leftEvent": "",
						"leftID": "",
						"leftField": "",
						"leftKeys": [],
						"leftTICategory": "",
						"leftTIField": "",
						"leftShared": false,
						"op": "",
						"rightKind": "",
						"rightEvent": "",
						"rightID": "",
						"rightField": "",
						"rightKeys": [],
						"rightTICategory": "",
						"rightTIField": "",
						"rightShared": false,
						"constant": "",
						"list": [],
						"ignoreCase": false,
						"filter": null,
						"vulns": {
							"cves": null,
							"minSeverity": 0
						}
					},
					"shared": false
				},
				"variables": [],
				"threshold": 0,
				"recovery": false
			}
		],
		"keepPolicy": "",
		"identicalFields": [
			"DestinationProcessName",
			"DeviceCustomString4",
			"DeviceEventClassID"
		],
		"uniqueFields": [],
		"priority": 1,
		"actions": {
			"onEveryEvent": {
				"output": true,
				"loop": false,
				"noAlert": false,
				"activeLists": [],
				"enrichment": [
					{
						"id": "",
						"name": "29ac5e35-aefa-46d8-845c-c0d6dc4d32a8",
						"targetField": "ExternalID",
						"label": "",
						"sourceKind": "constant",
						"sourceName": "",
						"sourceField": "",
						"constant": "detect_powershell_download",
						"keyFields": [],
						"template": "",
						"mutation": [],
						"maxTasks": 0,
						"cacheTTL": 0,
						"cacheDisabled": false,
						"filter": null,
						"debug": false,
						"searchBase": "",
						"workers": 0,
						"mapping": [],
						"keyMapping": [
							{
								"keyField": "",
								"mapping": []
							}
						],
						"timeout": 30,
						"attempts": 0,
						"domains": null,
						"connection": {
							"kind": "constant",
							"urls": [],
							"host": "",
							"port": "",
							"secretID": "",
							"clusterID": "",
							"tlsMode": "",
							"proxy": null,
							"rps": 0,
							"maxConns": 0,
							"urlPolicy": "",
							"version": "",
							"identityColumn": "",
							"identitySeed": "",
							"pollInterval": 0,
							"query": "",
							"stateID": "",
							"certificateSecretID": "",
							"authMode": "",
							"secretTemplateKind": "",
							"certSecretTemplateKind": ""
						},
						"shared": false
					}
				],
				"categorization": []
			}
		},
		"window": 0,
		"rateLimit": 0,
		"orderField": "",
		"shared": false
	}
}